/* ComponentDomParser 0.1.0 | @license MIT */
!function(o,n){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=n(o):o.define&&"function"==typeof o.define&&o.define.amd?o.define("ComponentDomParser",[],function(){return n(o)}):o.ComponentDomParser=n(o)}(window,function(o){"use strict";var n=o.document,e=function(o){this._checkForRequiredConstants(o),this.dataSelector=o.dataSelector,this.componentIndex=o.componentIndex,this.componentDidMountCallback=o.componentDidMountCallback,this.nonIndexedComponentPolicies=o.nonIndexedComponentPolicies||null,this._isLoggingEnabled=!1||o.isLoggingEnabled,this._policyRules=o.nonIndexedComponentPolicies?Object.keys(o.nonIndexedComponentPolicies):null,this._policyRulesRegex=this._policyRules?this._policyRules.map(function(o){return new RegExp("^"+o.replace(/[^\w\s]/g,"$&").replace(/\*/g,"\\w+")+"$")}):null,this._mountedElementsCache=[]};return e.prototype._checkForRequiredConstants=function(o){if(!o)throw new Error("ComponentDomParser Error: No option object was specified.");if(!o.dataSelector)throw new Error("ComponentDomParser Error: No dataSelector was specified.");if(!o.componentIndex)throw new Error("ComponentDomParser Error: No componentIndex was specified.");if(o.componentDidMountCallback&&"function"!=typeof o.componentDidMountCallback)throw new Error("ComponentDomParser Error: The componentDidMountCallback option must be a function.")},e.prototype.parse=function(o){o=o||n.body;var e=o.querySelectorAll("[data-"+this.dataSelector+"]"),t=Array.prototype.slice.call(e,0),i=this;return t.forEach(function(o){var n=o.dataset[i.dataSelector],e=i.componentIndex[n]||i._getNonIndexComponentPolicy(o,n);e?i._mountedElementsCache.indexOf(o)<0&&i._mountComponent(o,e):i._isLoggingEnabled&&console.info('ComponentDomParser Info: Component "'+n+'" isn`t present in the passed componentIndex while mounting a node.',i.componentIndex,o)}),this},e.prototype._mountComponent=function(o,n){var e=new n(o);return this._mountedElementsCache.push(o),this.componentDidMountCallback&&this.componentDidMountCallback(e),e},e.prototype._getNonIndexComponentPolicy=function(o,n){var e=this.nonIndexedComponentPolicies;if(e)for(var t=null,i=null,r=0;(t=this._policyRules[r])&&(i=this._policyRulesRegex[r]);r++)if(n.match(i)){var c=e[t],s=c(n,o);if(s)return s}return!1},e.prototype.addComponent=function(o,n){return this.componentIndex[o]=n,this},e});