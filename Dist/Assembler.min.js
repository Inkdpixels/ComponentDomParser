/* @reduct/assembler 0.1.1 | @license MIT */
!function(e,n){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=n(e):e.define&&"function"==typeof e.define&&e.define.amd?e.define("reductAssembler",[],function(){return n(e)}):e.reductAssembler=n(e)}(window,function(e){"use strict";var n=e.document,o=function(e){this._checkForRequiredConstants(e),this.dataSelector=e.dataSelector,this.componentIndex=e.componentIndex,this.componentDidMountCallback=e.componentDidMountCallback,this.nonIndexedComponentPolicies=e.nonIndexedComponentPolicies||null,this._isLoggingEnabled=e.isLoggingEnabled,this._policyRules=e.nonIndexedComponentPolicies?Object.keys(e.nonIndexedComponentPolicies):null,this._policyRulesRegex=this._policyRules?this._policyRules.map(function(e){return new RegExp("^"+e.replace(/[^\w\s]/g,"$&").replace(/\*/g,"\\w+.*")+"$")}):null,this._mountedElementsCache=[]};return o.prototype._checkForRequiredConstants=function(e){if(!e)throw new Error("@reduct/assembler Error: No option object was specified.");if(!e.dataSelector)throw new Error("@reduct/assembler Error: No dataSelector was specified.");if(!e.componentIndex)throw new Error("@reduct/assembler Error: No componentIndex was specified.");if(e.componentDidMountCallback&&"function"!=typeof e.componentDidMountCallback)throw new Error("@reduct/assembler Error: The componentDidMountCallback option must be a function.")},o.prototype.parse=function(e){e=e||n.body;var o=e.querySelectorAll("[data-"+this.dataSelector+"]"),t=Array.prototype.slice.call(o,0),i=this;return t.forEach(function(e){var n=e.dataset[i.dataSelector],o=i.componentIndex[n],t=i._getNonIndexComponentPolicy(e,n);o?i._mountedElementsCache.indexOf(e)<0&&i._mountComponent(e,o):t?i._mountComponent(e,o):i._isLoggingEnabled&&console.info('Assembler Info: Component "'+n+'" isn`t present in the passed componentIndex while mounting a node.',i.componentIndex,e)}),this},o.prototype._mountComponent=function(e,n){var o=new n(e);return this._mountedElementsCache.push(e),this.componentDidMountCallback&&this.componentDidMountCallback(o),o},o.prototype._getNonIndexComponentPolicy=function(e,n){var o=this.nonIndexedComponentPolicies;if(o)for(var t=null,i=null,r=0;(t=this._policyRules[r])&&(i=this._policyRulesRegex[r]);r++)if(n.match(i)){var c=o[t],s=c(n,e);if(s)return s}return!1},o.prototype.addComponent=function(e,n){return this.componentIndex[e]=n,this},o});